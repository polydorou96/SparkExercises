2024-08-02 02:02:51 - dao.logger - INFO - Initiating spark session...
2024-08-02 02:02:57 - dao.logger - INFO - Loading parquet files in spark dataframes...
2024-08-02 02:03:04 - dao.logger - INFO - Parquet files have been loaded successfully
2024-08-02 02:03:08 - dao.logger - INFO - Exercise 1:
2024-08-02 02:03:08 - dao.logger - INFO - We have collected a total number of 400000 applications
2024-08-02 02:03:13 - dao.logger - INFO - Exercise 2:
2024-08-02 02:03:13 - dao.logger - INFO - The average profit of all applications is: 140.87472103036544
2024-08-02 02:03:14 - dao.logger - INFO - Exercise 3:
2024-08-02 02:03:14 - dao.logger - INFO - These are the top 2 popular marketing sources:
2024-08-02 02:03:22 - dao.logger - INFO - +-------------+------------+-------------------+
|         Loan|Most popular|Second most popular|
+-------------+------------+-------------------+
|   loan_1 34%|    source_4|           source_3|
|  loan_10 99%|    source_3|           source_4|
| loan_100 86%|    source_2|           source_1|
|loan_1000 90%|    source_7|           source_3|
|loan_1001 41%|    source_8|           source_9|
|loan_1002 25%|    source_6|           source_4|
|loan_1003 63%|    source_3|           source_5|
|loan_1004 21%|    source_4|           source_9|
|loan_1005 75%|    source_2|           source_3|
|loan_1006 83%|    source_1|           source_3|
|loan_1007 49%|    source_4|           source_6|
|loan_1008 20%|    source_2|           source_4|
|loan_1009 82%|    source_8|           source_2|
| loan_101 51%|    source_6|           source_5|
|loan_1010 31%|    source_4|           source_8|
|loan_1011 60%|    source_3|           source_1|
|loan_1012 50%|    source_4|           source_7|
|loan_1013 72%|    source_3|           source_7|
|loan_1014 80%|    source_8|           source_1|
|loan_1015 76%|    source_6|           source_3|
+-------------+------------+-------------------+
only showing top 20 rows

2024-08-02 02:03:22 - dao.logger - INFO - Exercise 4:
2024-08-02 02:03:22 - dao.logger - INFO - These are the percentage profits from each marketing source:
2024-08-02 02:03:25 - dao.logger - INFO - +----------+--------+--------+------------------+
|      Date|  Source|  Profit|    Daily Target %|
+----------+--------+--------+------------------+
|2022-01-01|source_1|209591.0| 357.5113006396589|
|2022-01-01|source_2|212927.0|1122.5590468156895|
|2022-01-01|source_3|215349.0|306.86112456895324|
|2022-01-01|source_4|219513.0| 453.0244556805283|
|2022-01-01|source_5|206671.0| 575.8616846387472|
|2022-01-01|source_6|201571.0| 321.0189358347534|
|2022-01-01|source_7|212917.0|489.77962826647035|
|2022-01-01|source_8|207161.0| 826.7919859514687|
|2022-01-01|source_9|216693.0|1183.7266470009833|
|2022-01-02|source_1|206589.0|352.39061833688703|
|2022-01-02|source_2|212289.0|1119.1954871362295|
|2022-01-02|source_3|224828.0| 320.3682065604605|
|2022-01-02|source_4|208195.0|429.66670106284187|
|2022-01-02|source_5|213342.0| 594.4495527877623|
|2022-01-02|source_6|201902.0|321.54608144479306|
|2022-01-02|source_7|200965.0| 462.2860691939639|
|2022-01-02|source_8|213973.0| 853.9790868454661|
|2022-01-02|source_9|216921.0|1184.9721402818748|
|2022-01-03|source_1|217363.0| 370.7684434968017|
|2022-01-03|source_2|208720.0|  1100.37958667229|
+----------+--------+--------+------------------+
only showing top 20 rows

2024-08-02 02:03:25 - py4j.clientserver - INFO - Closing down clientserver connection
